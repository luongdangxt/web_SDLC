<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Navigation Avatar</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { border: 1px solid #ccc; margin: 10px 0; padding: 15px; }
        .nav-preview { background: #1e40af; color: white; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .nav-item { display: flex; align-items: center; gap: 8px; }
        .nav-avatar { width: 32px; height: 32px; border-radius: 50%; object-fit: contain; border: 2px solid white; }
        .info { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Test Navigation Avatar & Username</h1>
    
    <div class="test-section">
        <h3>1. Check Current User</h3>
        <button onclick="checkCurrentUser()">Check Current User</button>
        <div id="current-user-info"></div>
    </div>
    
    <div class="test-section">
        <h3>2. Navigation Preview</h3>
        <div class="nav-preview">
            <div class="nav-item">
                <img id="preview-avatar" src="https://source.unsplash.com/random/32x32/?portrait" alt="Avatar" class="nav-avatar">
                <span id="preview-username">Profile</span>
            </div>
        </div>
        <div id="nav-info" class="info"></div>
    </div>
    
    <div class="test-section">
        <h3>3. Test Functions</h3>
        <button onclick="testUpdateNavigation()">Test Update Navigation</button>
        <button onclick="simulateLogin()">Simulate Login</button>
        <button onclick="simulateLogout()">Simulate Logout</button>
    </div>

    <script>
        // Simulate currentUser from localStorage
        let currentUser = null;
        
        function checkCurrentUser() {
            const stored = localStorage.getItem('hotelBookingUser');
            if (stored) {
                currentUser = JSON.parse(stored);
            }
            
            const info = document.getElementById('current-user-info');
            if (currentUser) {
                info.innerHTML = `
                    <div class="info">
                        <strong>Current User:</strong><br>
                        Name: ${currentUser.name || 'N/A'}<br>
                        Username: ${currentUser.username || 'N/A'}<br>
                        Email: ${currentUser.email || 'N/A'}<br>
                        Role: ${currentUser.role || 'N/A'}<br>
                        Has Avatar: ${currentUser.avatar ? 'Yes' : 'No'}<br>
                        Avatar Length: ${currentUser.avatar ? currentUser.avatar.length : 'N/A'}
                    </div>
                `;
            } else {
                info.innerHTML = '<div class="info">No user logged in</div>';
            }
        }
        
        function updateNavigationAvatar() {
            const navAvatar = document.getElementById('preview-avatar');
            const navUsername = document.getElementById('preview-username');
            
            if (currentUser) {
                // Set avatar
                if (currentUser.avatar) {
                    navAvatar.src = currentUser.avatar;
                } else {
                    navAvatar.src = 'https://source.unsplash.com/random/32x32/?portrait';
                }
                
                // Set username
                const displayName = currentUser.name || currentUser.username || 'User';
                navUsername.textContent = displayName;
            } else {
                // Reset to default
                navAvatar.src = 'https://source.unsplash.com/random/32x32/?portrait';
                navUsername.textContent = 'Profile';
            }
            
            // Update info
            const navInfo = document.getElementById('nav-info');
            navInfo.innerHTML = `
                <strong>Navigation State:</strong><br>
                Avatar Source: ${navAvatar.src}<br>
                Username: ${navUsername.textContent}<br>
                User Logged In: ${currentUser ? 'Yes' : 'No'}
            `;
        }
        
        function testUpdateNavigation() {
            updateNavigationAvatar();
        }
        
        function simulateLogin() {
            // Simulate a logged in user
            currentUser = {
                id: 1,
                name: 'John Doe',
                username: 'johndoe',
                email: 'john@example.com',
                role: 'User',
                avatar: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k='
            };
            localStorage.setItem('hotelBookingUser', JSON.stringify(currentUser));
            updateNavigationAvatar();
            checkCurrentUser();
        }
        
        function simulateLogout() {
            currentUser = null;
            localStorage.removeItem('hotelBookingUser');
            updateNavigationAvatar();
            checkCurrentUser();
        }
        
        // Initialize
        checkCurrentUser();
        updateNavigationAvatar();
    </script>
</body>
</html> 